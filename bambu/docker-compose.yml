services:
  bambuddy:
    image: ghcr.io/maziggy/bambuddy:latest
    # build: .
    # Usage:
    #   docker compose up -d          → pulls pre-built image from ghcr.io
    #   docker compose up -d --build  → builds locally from source
    container_name: bambuddy
    #
    # LINUX: Use host mode for printer discovery and camera streaming
    network_mode: host
    #
    # macOS/WINDOWS: Docker Desktop doesn't support host mode.
    # Comment out "network_mode: host" above and uncomment "ports:" below.
    # Note: Printer discovery won't work - add printers manually by IP.
    #ports:
    #  - "${PORT:-8000}:8000"
    volumes:
      - /volume1/docker/bambu/data:/app/data
      - /volume1/docker/bambu/logs:/app/logs
      #
      # Share virtual printer certs with native installation
      # This ensures the slicer only needs to trust one CA certificate.
      # - ./virtual_printer:/app/data/virtual_printer
    environment:
      - TZ=America/Los_Angeles
      # Port BamBuddy runs on (default: 8000)
      # Usage: PORT=8080 docker compose up -d
      - PORT=8003
    restart: unless-stopped

  wyze-bridge:
      container_name: wyze-bridge
      restart: unless-stopped
      image: mrlt8/wyze-bridge:latest
      ports:
          - 1935:1935 # RTMP
          - 8554:8554 # RTSP
          - 8888:8888 # HLS
          - 8889:8889 #WebRTC
          - 8189:8189/udp # WebRTC/ICE
          - 5003:5000 # WEB-UI
      environment:
          # [OPTIONAL] Credentials can be set in the WebUI
          # API Key and ID can be obtained from the wyze dev portal: 
          # https://developer-api-console.wyze.com/#/apikey/view
          # - WYZE_EMAIL=
          # - WYZE_PASSWORD= 
          # - API_ID=
          # - API_KEY= 
          # [OPTIONAL] IP Address of the host to enable WebRTC e.g.,:
          # - WB_IP=192.168.1.122
          # WebUI and Stream authentication:
          - WB_AUTH=True # Set to false to disable web and stream auth.
          # WB_USERNAME=
          # WB_PASSWORD=